---
icon: face-disguise
---

# Spyware Reverse Engineering



## Android App Structure

<figure><img src="../../../.gitbook/assets/image (1) (1) (1) (1) (1) (1) (1) (1).png" alt=""><figcaption><p>Android APK Structure</p></figcaption></figure>

## Tools

* [ **jadx – Dex to Java decompiler**](https://github.com/skylot/jadx)
* [**Apktool – Decode & Rebuild Apk**](https://ibotpeaches.github.io/Apktool/)
* [**APK EDITOR STUDIO – Free, Open source & Cross-platform APK editor**](https://qwertycube.com/apk-editor-studio)
* [**Uber Apk Signer – Signing and zip aligning Apk**](https://github.com/patrickfav/uber-apk-signer)
* [**dex2jar – Tools to work with android .dex and java .class files**](https://github.com/pxb1988/dex2jar)
* [**GDA – Android Reversing Tool**](https://github.com/charles2gan/GDA-android-reversing-Tool)
* [**JD-GUI – Displays Java sources from CLASS files**](https://github.com/java-decompiler/jd-gui)
* [**Dexplorer – Explore apk from Android Device**](https://play.google.com/store/apps/details?id=com.dexplorer)
* [**Ghidra**](https://ghidra-sre.org/)

## Android Permissions

Please reference this [permissions overview ↗](https://developer.android.com/guide/topics/permissions/overview#permission-groups) for descriptions of the listed permissions that are considered dangerous.

```bash
READ_CALENDAR
WRITE_CALENDAR
READ_CALL_LOG
WRITE_CALL_LOG
PROCESS_OUTGOING_CALLS
CAMERA
READ_CONTACTS
WRITE_CONTACTS
GET_ACCOUNTS
ACCESS_FINE_LOCATION
ACCESS_COARSE_LOCATION
RECORD_AUDIO
READ_PHONE_STATE
READ_PHONE_NUMBERS
CALL_PHONE
ANSWER_PHONE_CALLS
ADD_VOICEMAIL
USE_SIP
BODY_SENSORS
SEND_SMS
RECEIVE_SMS
READ_SMS
RECEIVE_WAP_PUSH
RECEIVE_MMS
READ_EXTERNAL_STORAGE
WRITE_EXTERNAL_STORAGE
```

## Important Android Components

* **Activities** A key component of most Android apps, activities can handle unexpected changes, device rotation, and data saving&#x20;
* **Services** Run in the background of an app to perform long-running tasks without a user interface&#x20;
* **Broadcast receivers** Respond to system-wide broadcast announcements, known as Intents, to perform functions like alerting the user when the battery is low&#x20;
* **Intents** A frequently used component that allows users to call other app components, activities, or applications on the phone&#x20;
* **Fragments** A reusable portion of an app's UI that manages its own layout, lifecycle, and input events&#x20;
* **Lists** A key UI element that represents a range of information&#x20;
* **RecyclerView** A commonly used Android component for displaying a list of items&#x20;
* **Android architecture** The foundation of the Android mobile operating system, which is essential for creating high-quality and scalable apps&#x20;
* **Jetpack Compose** A tool that simplifies the process of building complex UIs, saving developers time and reducing errors

## Android Services and Receivers

### Services

Services are critical application components that can perform long-time operations. For example, Spotify services can play music in the background even if the app is closed.

### Broadcast Receivers

They respond to broadcast messages from another application or system, for example, a low battery message, or a no wifi connection message. They can respond to these types of messages. They can receive messages from other apps. They have various types, such as SMS broadcast receiver, Battery state, etc. You can create your own custom broadcast receiver.

## Decompiling an APK

### [Jadx-GUI](https://github.com/java-decompiler/jd-gui)

{% hint style="info" %}
Open the .apk file with jadx-gui by right clicking on the apk file and selecting the open with option.
{% endhint %}

#### Install Jadx Using

```
sudo apt install jadx
```

<figure><img src="../../../.gitbook/assets/image (1) (1) (1) (1) (1) (1) (1) (1) (1).png" alt=""><figcaption><p>android manifest file review</p></figcaption></figure>

{% hint style="info" %}
The same thing can be achieved using [https://mobsf.live/](https://mobsf.live/)
{% endhint %}





***

## REFERENCES

* [https://rene-manqueros.medium.com/reverse-engineering-an-android-app-40996ab29122](https://rene-manqueros.medium.com/reverse-engineering-an-android-app-40996ab29122)
* [https://github.com/user1342/Awesome-Android-Reverse-Engineering](https://github.com/user1342/Awesome-Android-Reverse-Engineering)
* [https://medium.com/@brotheralameen/malware-analysis-of-pegasus-spyware-70fe090f7cc2](https://medium.com/@brotheralameen/malware-analysis-of-pegasus-spyware-70fe090f7cc2)
* [https://www.corellium.com/blog/android-mobile-reverse-engineering](https://www.corellium.com/blog/android-mobile-reverse-engineering)
* [https://epic.blog/reverse-engineering/2020/07/27/reverse-engineering-android-app.html](https://epic.blog/reverse-engineering/2020/07/27/reverse-engineering-android-app.html)
* [https://developer.android.com/guide/topics/permissions/overview](https://developer.android.com/guide/topics/permissions/overview)
* [https://mas.owasp.org/MASTG/tests/android/MASVS-PLATFORM/MASTG-TEST-0024/#android-permissions](https://mas.owasp.org/MASTG/tests/android/MASVS-PLATFORM/MASTG-TEST-0024/#android-permissions)
* [https://www.techaheadcorp.com/blog/exploring-android-app-components-creating-dynamic-user-experiences/](https://www.techaheadcorp.com/blog/exploring-android-app-components-creating-dynamic-user-experiences/)
* [https://medium.com/@eren.mollaoglu/components-in-android-ea0a3f56aa42](https://medium.com/@eren.mollaoglu/components-in-android-ea0a3f56aa42)
*



