# CVE-2025-24054, NTLM Exploit in the Wild

**CVE-2025-24054** is a medium-severity vulnerability in Microsoft Windows that allows attackers to leak NTLM (NT LAN Manager) hashes through spoofing techniques. This flaw arises from improper handling of file paths in `.library-ms` files, enabling attackers to initiate unauthorized SMB (Server Message Block) authentication requests and capture sensitive user credentials.[LevelBlue Open Threat Exchange+5The Hacker News+5Check Point Research+5](https://thehackernews.com/2025/04/cve-2025-24054-under-active.html?utm_source=chatgpt.com)[Dark Reading+4GitHub+4The Hacker News+4](https://github.com/helidem/CVE-2025-24054-PoC?utm_source=chatgpt.com)

***

#### Overview

* **CVE ID**: CVE-2025-24054
* **Severity**: Medium (CVSS 3.1 Score: 6.5)
* **Affected Component**: Windows NTLM Authentication
* **CWE Reference**: CWE-73 â€“ External Control of File Name or Path
* **Attack Vector**: Network
* **User Interaction**: Required (e.g., viewing a folder)
* **Privileges Required**: None
* **Impact**: Confidentiality breach via NTLM hash disclosure[Aqua Vulnerability Database+2CVE Database+2The Hacker News+2](https://www.cvedetails.com/cve/CVE-2025-24054/?utm_source=chatgpt.com)[The Hacker News+6NVD+6CVE Database+6](https://nvd.nist.gov/vuln/detail/CVE-2025-24054?utm_source=chatgpt.com)[CISA+6LinkedIn+6The Hacker News+6](https://www.linkedin.com/pulse/cve-2025-24054-ntlm-exploit-huntmetrics-luafe?utm_source=chatgpt.com)

***

#### Technical Details

The vulnerability exploits how Windows Explorer processes `.library-ms` files, which are XML-based files defining custom libraries. When such a file references a remote location (e.g., an attacker-controlled SMB share), merely previewing or navigating to the folder containing the file can trigger an automatic SMB authentication request. This request inadvertently sends the user's NTLM hash to the attacker's server, potentially compromising user credentials.[Dark Reading+4LinkedIn+4GitHub+4](https://www.linkedin.com/pulse/cve-2025-24054-ntlm-exploit-huntmetrics-luafe?utm_source=chatgpt.com)[LevelBlue Open Threat Exchange+6Check Point Research+6The Hacker News+6](https://research.checkpoint.com/2025/cve-2025-24054-ntlm-exploit-in-the-wild/?utm_source=chatgpt.com)

Notably, the exploit does not require the user to open or execute the malicious file; simple actions like right-clicking or hovering over the file are sufficient to trigger the vulnerability. [Dark Reading](https://www.darkreading.com/cyberattacks-data-breaches/multiple-group-exploiting-ntlm-flaw?utm_source=chatgpt.com)

***

#### Example Exploit Scenario

1. **Attacker Setup**: An attacker sets up a malicious SMB server to capture incoming NTLM authentication requests.
2. **Malicious File Creation**: The attacker crafts a `.library-ms` file that references the malicious SMB server.
3. **Distribution**: The malicious file is distributed via phishing emails, often compressed within a ZIP archive alongside other shortcut files like `.url`, `.lnk`, or `.website`.
4. **User Interaction**: When the victim extracts the archive or navigates to the folder containing the malicious file, Windows Explorer initiates an SMB authentication request to the attacker's server.
5. **Credential Capture**: The attacker's server captures the NTLM hash from the authentication request, which can then be used for offline brute-force attacks or pass-the-hash techniques to gain unauthorized access. [CVE+8GitHub+8LinkedIn+8](https://github.com/helidem/CVE-2025-24054-PoC?utm_source=chatgpt.com)[LinkedIn](https://www.linkedin.com/pulse/cve-2025-24054-ntlm-exploit-huntmetrics-luafe?utm_source=chatgpt.com)[GitHub+2Check Point Research+2The Hacker News+2](https://research.checkpoint.com/2025/cve-2025-24054-ntlm-exploit-in-the-wild/?utm_source=chatgpt.com)[The Hacker News+1LinkedIn+1](https://thehackernews.com/2025/04/cve-2025-24054-under-active.html?utm_source=chatgpt.com)

***

#### Timeline of Events

* **March 11, 2025**: Microsoft releases a security patch addressing CVE-2025-24054.
* **March 19, 2025**: Reports emerge of active exploitation in the wild, with attackers leveraging the vulnerability in phishing campaigns targeting organizations in Poland and Romania.
* **April 17, 2025**: The U.S. Cybersecurity and Infrastructure Security Agency (CISA) adds CVE-2025-24054 to its Known Exploited Vulnerabilities Catalog, urging immediate remediation. [YouTube+8The Hacker News+8Check Point Research+8](https://thehackernews.com/2025/04/cve-2025-24054-under-active.html?utm_source=chatgpt.com)

***

#### Mitigation Strategies

* **Apply Security Updates**: Ensure that all Windows systems are updated with the latest security patches released by Microsoft on March 11, 2025.
* **Disable NTLM Authentication**: Where feasible, disable NTLM authentication or restrict its use to minimize exposure.
* **Implement SMB Signing**: Enforce SMB signing to prevent unauthorized SMB communication.
* **User Education**: Train users to recognize and avoid suspicious emails and attachments, particularly those containing unexpected shortcut files.
* **Network Monitoring**: Monitor network traffic for unusual SMB authentication requests, which may indicate exploitation attempts.

***

#### Additional Resources

* [Microsoft Security Advisory: CVE-2025-24054](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2025-24054)
* [Check Point Research: CVE-2025-24054 Analysis](https://research.checkpoint.com/2025/cve-2025-24054-ntlm-exploit-in-the-wild/)
* [CISA Known Exploited Vulnerabilities Catalog](https://www.cisa.gov/known-exploited-vulnerabilities-catalog)
* [https://www.youtube.com/watch?v=d06oveNhIYo\&list=WL\&index=4\&ab\_channel=TheWeeklyPurpleTeam](https://www.youtube.com/watch?v=d06oveNhIYo\&list=WL\&index=4\&ab_channel=TheWeeklyPurpleTeam)

